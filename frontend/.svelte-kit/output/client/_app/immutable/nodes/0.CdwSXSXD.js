import{a as p,b as O,f as h,s as W,e as j}from"../chunks/CXN8AEkE.js";import{i as B}from"../chunks/Ba5BHlZf.js";import{o as H}from"../chunks/PPGuM6Ad.js";import{K as g,a3 as R,a2 as V,a4 as G,aD as J,aa as Q,aq as P,a8 as S,a0 as C,a9 as U,a1 as X,w as $,q as o,t as n,m as Y,n as Z,o as aa,s as ea,A as ra,aE as ta,a as ia,r as m,$ as sa,v as oa}from"../chunks/DrZxtosp.js";import{i as w}from"../chunks/C09UTFEA.js";import{s as na,c as la}from"../chunks/CGYafap6.js";import{s as fa,a as ca}from"../chunks/DbI0K5eF.js";import{r as da,s as M,c as va,d as ua}from"../chunks/C0-kHXY5.js";import{r as ma}from"../chunks/BobeNIf_.js";import{a as z}from"../chunks/DJ05b8fX.js";import{p as pa}from"../chunks/DpCRy2tt.js";function ga(s,r,a,i,v){var u;g&&R();var e=(u=r.$$slots)==null?void 0:u[a],d=!1;e===!0&&(e=r.children,d=!0),e===void 0||e(s,d?()=>i:i)}function ha(s,r){let a=null,i=g;var v;if(g){a=U;for(var e=X(document.head);e!==null&&(e.nodeType!==Q||e.data!==s);)e=P(e);if(e===null)S(!1);else{var d=P(e);e.remove(),C(d)}}g||(v=document.head.appendChild(V()));try{G(()=>r(v),J)}finally{i&&(S(!0),C(a))}}var _a=O('<svg class="logo" viewBox="0 0 64 64" aria-hidden="true" focusable="false"><rect x="6" y="6" width="52" height="52" rx="14" fill="currentColor"></rect><path d="M32 16l12 20h-8v16h-8V36h-8l12-20z" fill="#0a2540"></path><circle cx="32" cy="47" r="5" fill="#0a2540"></circle></svg>');function ya(s,r){let a=pa(r,"size",8,48);var i=_a();$(()=>{z(i,"width",a()),z(i,"height",a())}),p(s,i)}var ba=h('<div class="loading-screen" role="status" aria-live="polite"><div class="loading-logo logo-badge"><!></div></div>');function wa(s){var r=ba(),a=o(r),i=o(a);ya(i,{size:96}),n(a),n(r),p(s,r)}var $a=h('<a href="/admin">Admin</a>'),ka=h('<header class="topbar"><div class="topbar-inner"><nav class="nav"><a href="/">Ãœbersicht</a> <a href="/calendar">Kalender</a> <a href="/inventory">Material</a> <a href="/nfc">NFC</a> <a href="/packlists">Packlisten</a> <a href="/settings">Einstellungen</a> <!></nav> <div class="user-menu"><span> </span> <button class="btn btn-outline">Logout</button></div></div></header>'),xa=h('<!> <div class="app-shell"><!> <main><!></main></div>',1);function Da(s,r){Y(r,!1);const a=()=>ca(M,"$session",i),[i,v]=fa();let e=oa(!1);const d=async()=>{const t="pfadi_permissions_requested";if(!(typeof localStorage>"u")&&localStorage.getItem(t)!=="true"&&sa(M)){localStorage.setItem(t,"true");try{"Notification"in window&&Notification.permission==="default"&&await Notification.requestPermission()}catch(l){console.warn("Notification permission failed",l)}try{"Notification"in window&&Notification.permission==="granted"&&await ma()}catch(l){console.warn("Push registration failed",l)}}};H(async()=>{if(da(),"serviceWorker"in navigator)try{await navigator.serviceWorker.register("/service-worker.js")}catch(t){console.warn("Service worker registration failed",t)}await d(),ea(e,!0)}),B();var u=xa();ha("12qhfyh",t=>{ra(()=>{ta.title="Pfadfinder Orga"})});var k=Z(u);{var L=t=>{wa(t)};w(k,t=>{ia(e)||t(L)})}var x=m(k,2),N=o(x);{var T=t=>{var l=ka(),E=o(l),y=o(E),D=m(o(y),12);{var F=f=>{var c=$a();p(f,c)};w(D,f=>{var c;((c=a())==null?void 0:c.role)==="admin"&&f(F)})}n(y);var q=m(y,2),b=o(q),I=o(b);n(b);var K=m(b,2);n(q),n(E),n(l),$(f=>W(I,`${a().username??""} (${f??""})`),[()=>va(a().role)]),j("click",K,function(...f){var c;(c=ua)==null||c.apply(this,f)}),p(t,l)};w(N,t=>{a()&&t(T)})}var _=m(N,2),A=o(_);ga(A,r,"default",{}),n(_),n(x),$(()=>na(_,1,la(a()?"container":"auth-container"))),p(s,u),aa(),v()}export{Da as component};
